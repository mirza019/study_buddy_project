schemaVersion: 2.0
type: application

metadata:
  name: study-buddy-ai-bot
  description: Telegram Study Buddy AI bot running as a background worker.

build:
  env:
    - name: PIP_DEFAULT_TIMEOUT
      value: "100"

  steps:
    - name: Install dependencies
      command: pip install --upgrade pip && pip install -r requirements_bot.txt

run:
  command: python bot.py
  restartPolicy: always

container:
  port: 8080     # Required even for worker bots
  startCommand: python bot.py

network:
  expose: false   # <-- No incoming HTTP traffic (Telegram uses polling)

scaling:
  minReplicas: 1
  maxReplicas: 1

env:
  - name: TELEGRAM_TOKEN
    valueFrom:
      secretRef:
        name: telegram-token

  - name: GEMINI_API_KEY
    valueFrom:
      secretRef:
        name: gemini-key
