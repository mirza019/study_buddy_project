schemaVersion: 1.2
kind: Component

metadata:
  name: study-buddy-project
  description: Telegram Bot for StudyBuddy AI

build:
  builder: docker.io/library/python:3.11
  commands:
    - pip install --upgrade pip
    - pip install -r requirements_bot.txt

run:
  command: bash -c "python3 health.py & python3 bot.py"
  containerPort: 8000

endpoints:
  - name: health
    type: REST
    networkVisibility: Public
    contextPath: /
    service:
      port: 8000

network:
  expose: true

scaling:
  mode: manual
  minReplicas: 1
  maxReplicas: 1

env:
  - name: TELEGRAM_TOKEN
    valueFrom:
      secretRef:
        name: telegram-token

  - name: GEMINI_API_KEY
    valueFrom:
      secretRef:
        name: gemini-key
